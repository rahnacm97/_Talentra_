"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const admin_authController_1 = require("../../controllers/admin/admin.authController");
const admin_candidateController_1 = require("../../controllers/admin/admin.candidateController");
const admin_employerController_1 = require("../../controllers/admin/admin.employerController");
const adminJob_controller_1 = require("../../controllers/job/adminJob.controller");
const admin_authService_1 = require("../../services/admin/admin.authService");
const admin_candidateService_1 = require("../../services/admin/admin.candidateService");
const admin_employerService_1 = require("../../services/admin/admin.employerService");
const candidate_repository_1 = require("../../repositories/candidate/candidate.repository");
const employer_repository_1 = require("../../repositories/employer/employer.repository");
const authMiddleware_1 = require("../../middlewares/authMiddleware");
const token_service_1 = require("../../services/auth/token.service");
const admin_repository_1 = require("../../repositories/admin/admin.repository");
const admin_mapper_1 = require("../../mappers/admin/admin.mapper");
const adminCandidate_mapper_1 = require("../../mappers/admin/adminCandidate.mapper");
const adminEmployer_mapper_1 = require("../../mappers/admin/adminEmployer.mapper");
const NotificationAdapter_1 = require("../../services/notification/NotificationAdapter");
const job_service_1 = require("../../services/job/job.service");
const adminJob_mapper_1 = require("../../mappers/admin/adminJob.mapper");
const job_repository_1 = require("../../repositories/job/job.repository");
const enums_1 = require("../../shared/enums/enums");
const admin_analyticsController_1 = require("../../controllers/admin/admin.analyticsController");
const admin_analyticsService_1 = require("../../services/admin/admin.analyticsService");
const application_repository_1 = require("../../repositories/application/application.repository");
const interview_repository_1 = require("../../repositories/interview/interview.repository");
const admin_analytics_mapper_1 = require("../../mappers/admin/admin.analytics.mapper");
const router = (0, express_1.Router)();
//Dependencies
const adminRepository = new admin_repository_1.AdminRepository();
const tokenService = new token_service_1.TokenService();
const adminMapper = new admin_mapper_1.AdminMapper();
const candidateMapper = new adminCandidate_mapper_1.CandidateMapper();
const employerMapper = new adminEmployer_mapper_1.EmployerMapper();
const notificationAdapter = new NotificationAdapter_1.NotificationAdapter();
const adminJobMapper = new adminJob_mapper_1.AdminJobMapper();
const jobRepo = new job_repository_1.JobRepository();
const candidateRepo = new candidate_repository_1.CandidateRepository();
const employerRepo = new employer_repository_1.EmployerRepository();
const applicationRepo = new application_repository_1.ApplicationRepository();
const interviewRepo = new interview_repository_1.InterviewRepository();
const mapper = new admin_analytics_mapper_1.AdminAnalyticsMapper();
// Services
const adminAuthService = new admin_authService_1.AdminAuthService(adminRepository, tokenService, adminMapper);
const adminCandidateService = new admin_candidateService_1.AdminCandidateService(new candidate_repository_1.CandidateRepository(), candidateMapper, notificationAdapter);
const adminEmployerService = new admin_employerService_1.AdminEmployerService(new employer_repository_1.EmployerRepository(), employerMapper, notificationAdapter);
const jobService = new job_service_1.AdminJobService(jobRepo, adminJobMapper);
const analyticsRepository = new admin_repository_1.AdminAnalyticsRepository(candidateRepo, employerRepo, jobRepo, applicationRepo, interviewRepo);
const analyticsService = new admin_analyticsService_1.AdminAnalyticsService(analyticsRepository, mapper);
// Controllers
const adminAuthController = new admin_authController_1.AdminAuthController(adminAuthService);
const adminCandidateController = new admin_candidateController_1.AdminCandidateController(adminCandidateService);
const adminEmployerController = new admin_employerController_1.AdminEmployerController(adminEmployerService);
const jobController = new adminJob_controller_1.AdminJobController(jobService);
const analyticsController = new admin_analyticsController_1.AdminAnalyticsController(analyticsService);
// Routes
router.post("/login", adminAuthController.login);
router.get("/candidates", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), adminCandidateController.getAllCandidates);
router.get("/candidates/:id", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), adminCandidateController.getCandidateById);
router.patch("/candidates/block-unblock", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), adminCandidateController.blockUnblockCandidate);
router.get("/employers", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), adminEmployerController.getAllEmployers);
router.get("/employers/:id", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), adminEmployerController.getEmployerById);
router.patch("/employers/block-unblock", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), adminEmployerController.blockUnblockEmployer);
router.patch("/employers/:id/verify", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), adminEmployerController.verifyEmployer);
router.patch("/employers/:id/reject", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), adminEmployerController.rejectEmployer);
router.get("/jobs", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), jobController.getAdminJobs.bind(jobController));
router.get("/analytics/dashboard", (0, authMiddleware_1.verifyAuth)([enums_1.USER_ROLES.ADMIN]), analyticsController.getDashboardAnalytics);
router.post("/logout", adminAuthController.logout);
exports.default = router;
//# sourceMappingURL=admin.routes.js.map